<!DOCTYPE html>
{% load static %}
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Citas</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen p-4 md:p-8 text-slate-800">
    <div class="max-w-[1280px] mx-auto space-y-6">
        <header class="rounded-3xl shadow bg-gradient-to-r from-slate-950 via-slate-900 to-cyan-900 text-white p-5 md:p-7">
            <div class="flex flex-col xl:flex-row xl:items-start xl:justify-between gap-5">
                <div>
                    <p class="text-xs uppercase tracking-[0.24em] text-slate-300">Jonathan CA Photography</p>
                    <h1 class="mt-2 text-2xl md:text-4xl font-bold">Panel de Citas</h1>
                    <p class="mt-2 text-sm md:text-base text-slate-200">
                        Agenda, seguimiento de estados y bandeja de clientes con dudas desde WhatsApp.
                    </p>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-2 gap-2 min-w-[260px]">
                    <a href="/bot-manager/" class="inline-flex items-center justify-center gap-2 bg-emerald-600 hover:bg-emerald-500 px-3 py-2 rounded-xl text-sm font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L5 21.75V17H3a1 1 0 01-1-1V4a1 1 0 011-1h18a1 1 0 011 1v12a1 1 0 01-1 1H9.75z"/></svg>
                        <span>Editor del bot</span>
                    </a>
                    <a href="/servicios-manager/" class="inline-flex items-center justify-center gap-2 bg-cyan-700 hover:bg-cyan-600 px-3 py-2 rounded-xl text-sm font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7h16M4 12h16M4 17h10"/></svg>
                        <span>Servicios</span>
                    </a>
                    <a href="/calendario-panel/" class="inline-flex items-center justify-center gap-2 bg-indigo-700 hover:bg-indigo-600 px-3 py-2 rounded-xl text-sm font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><rect x="3" y="5" width="18" height="16" rx="2" ry="2" stroke-width="2"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 3v4M8 3v4M3 11h18"/></svg>
                        <span>Vista calendario</span>
                    </a>
                    <a href="/citas/nueva/" class="inline-flex items-center justify-center gap-2 bg-orange-600 hover:bg-orange-500 px-3 py-2 rounded-xl text-sm font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v14m-7-7h14"/></svg>
                        <span>Nueva cita manual</span>
                    </a>
                    <a href="/chats/" class="inline-flex items-center justify-center gap-2 bg-amber-600 hover:bg-amber-500 px-3 py-2 rounded-xl text-sm font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h8m-8 4h5m-9 7l3.5-3H19a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2h1.5L8 21z"/></svg>
                        <span>Chats</span>
                    </a>
                    <button id="refreshBtn" class="inline-flex items-center justify-center gap-2 bg-white/15 hover:bg-white/25 border border-white/30 px-3 py-2 rounded-xl text-sm font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v6h6M20 20v-6h-6M20 9a8 8 0 00-13.66-4.66L4 10M4 15a8 8 0 0013.66 4.66L20 14"/></svg>
                        <span>Actualizar</span>
                    </button>
                </div>
            </div>
        </header>

        <section class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-5 gap-3">
            <article class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm">
                <p class="text-xs uppercase text-slate-500">Total de citas</p>
                <p id="statTotal" class="text-3xl font-black text-slate-900 mt-1">0</p>
            </article>
            <article class="rounded-2xl border border-amber-100 bg-amber-50 p-4 shadow-sm">
                <p class="text-xs uppercase text-amber-700">Pendientes</p>
                <p id="statPending" class="text-3xl font-black text-amber-700 mt-1">0</p>
            </article>
            <article class="rounded-2xl border border-emerald-100 bg-emerald-50 p-4 shadow-sm">
                <p class="text-xs uppercase text-emerald-700">Confirmadas</p>
                <p id="statConfirmed" class="text-3xl font-black text-emerald-700 mt-1">0</p>
            </article>
            <article class="rounded-2xl border border-rose-100 bg-rose-50 p-4 shadow-sm">
                <p class="text-xs uppercase text-rose-700">Canceladas</p>
                <p id="statCancelled" class="text-3xl font-black text-rose-700 mt-1">0</p>
            </article>
            <article class="rounded-2xl border border-orange-200 bg-orange-50 p-4 shadow-sm">
                <p class="text-xs uppercase text-orange-700">Clientes con dudas</p>
                <p id="statDoubts" class="text-3xl font-black text-orange-700 mt-1">0</p>
            </article>
        </section>

        <section class="bg-white rounded-3xl border border-orange-200 shadow-sm p-4 md:p-5">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-4">
                <div>
                    <h2 class="text-lg md:text-xl font-bold text-slate-900">Bandeja de dudas del bot</h2>
                    <p class="text-sm text-slate-600">Aquí ves a los clientes que marcaron dudas en el flujo y requieren atención humana.</p>
                </div>
                <a href="/chats/" class="inline-flex items-center justify-center rounded-xl bg-orange-600 hover:bg-orange-500 text-white text-sm font-semibold px-4 py-2">
                    Ir a chats
                </a>
            </div>
            <div id="doubtsList" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3">
                <article class="rounded-xl border border-slate-200 p-4 bg-slate-50 text-sm text-slate-500">Cargando clientes con dudas...</article>
            </div>
        </section>

        <section class="bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden">
            <div class="px-4 md:px-5 py-4 border-b bg-slate-50 flex items-center justify-between gap-2">
                <div>
                    <h2 class="font-bold text-slate-800">Listado de citas</h2>
                    <p class="text-xs text-slate-500">Gestiona estado, consulta notas y abre chat directo.</p>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full">
                    <thead class="bg-slate-900 text-white text-left text-sm">
                        <tr>
                            <th class="px-4 py-3">Cliente</th>
                            <th class="px-4 py-3">Contacto</th>
                            <th class="px-4 py-3">Servicio</th>
                            <th class="px-4 py-3">Paquete</th>
                            <th class="px-4 py-3">Fecha</th>
                            <th class="px-4 py-3">Hora</th>
                            <th class="px-4 py-3">Precio</th>
                            <th class="px-4 py-3">Anticipo</th>
                            <th class="px-4 py-3">Nota del cliente</th>
                            <th class="px-4 py-3">Estado</th>
                            <th class="px-4 py-3">Origen</th>
                            <th class="px-4 py-3">Gestión</th>
                        </tr>
                    </thead>
                    <tbody id="bookingsTbody" class="bg-white text-sm">
                        <tr>
                            <td colspan="12" class="px-4 py-6 text-center text-slate-500">Cargando citas...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <p id="dashboardFeedback" class="text-sm text-slate-500"></p>
    </div>

    <script src="{% static 'js/calendar.js' %}?v=20260220-4"></script>
</body>
</html>
